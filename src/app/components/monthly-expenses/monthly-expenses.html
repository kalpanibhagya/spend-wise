<section>
    <div class="month-nav">
        <button (click)="prevMonth()">◀</button>
        <span> {{ selectedDate | date: 'MMMM yyyy' }} </span>
        <button (click)="nextMonth()" [disabled]="isNextMonthDisabled()">▶</button>
    </div>
    <button class="add-btn" (click)="openAddForm()">Add Expense</button>
    <div *ngIf="expenses.length === 0">
        <p>No expenses recorded for this month.</p>
    </div>
    <table class="expense-summary" *ngIf="expenses.length > 0">
        <thead>
            <tr>
                <th></th>
                <th>Expense</th>
                <th>Category</th>
                <th>Due date</th>
                <th>Amount</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let expense of expenses">
                <!-- Checkbox + Recurring -->
                <td class="select-col">
                    <input type="checkbox" />
                    <i 
                        *ngIf="expense.recurring" 
                        class="fa-solid fa-arrows-rotate icon recurring" 
                        title="Recurring Expense">  </i>
                </td>
                <td>{{ expense.name }}</td>
                <td>{{ expense.category }}</td>
                <td>{{ (expense.dueDate || expense.date) | date: 'yyyy-MM-dd' }}</td>
                <td>€ {{ expense.amount }}</td>
                <td class="status-col">
                    <i 
                        *ngIf="expense.status === 'paid'" 
                        class="fa-solid fa-circle-check icon paid">
                    </i>

                    <i 
                        *ngIf="expense.status === 'unpaid'" 
                        class="fa-regular fa-clock icon pending">
                    </i>

                    <i 
                        *ngIf="expense.status === 'overdue'" 
                        class="fa-solid fa-triangle-exclamation icon overdue">
                    </i>
                </td>
            </tr>
        </tbody>
    </table>

    <p *ngIf="expenses.length > 0" class="total-expense">
        Total: € {{ totalExpenses() }}
</section>

<section>
    <div *ngIf="expenses.length > 0" class="chart-wrapper">
    <div echarts [options]="chartOptions" class="chart-box"></div>
    </div>
</section>

<div class="modal-wrapper" *ngIf="showForm">
  <div class="modal-box">
      <app-expense-form 
         (expenseAdded)="onExpenseAdded($event)" 
         (close)="closeForm()">
      </app-expense-form>
  </div>
</div>